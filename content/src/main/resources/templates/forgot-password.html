<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}">
<head><title>비밀번호 찾기</title></head>
<body>
<div layout:fragment="content">
    <div class="auth-layout">
        <div class="auth-box">
            <h1>비밀번호 찾기</h1>
            <p style="text-align:center;color:var(--text-secondary);font-size:14px;margin-bottom:24px;">
                이메일을 입력하시면 재설정 링크를 보내드립니다.
            </p>
            <div id="errorMsg" class="error-message"></div>
            <div id="successMsg" class="success-message"></div>
            <div class="form-group">
                <input type="email" id="email" placeholder="이메일 주소">
            </div>
            <button class="btn btn-primary" onclick="sendResetLink()">재설정 링크 보내기</button>
            <div class="auth-link">
                <a href="/login">로그인으로 돌아가기</a>
            </div>
        </div>
    </div>
    <script>
    async function sendResetLink() {
        var email = document.getElementById('email').value;
        var errorEl = document.getElementById('errorMsg');
        var successEl = document.getElementById('successMsg');
        errorEl.style.display = 'none';
        successEl.style.display = 'none';
        if (!email) { errorEl.textContent = '이메일을 입력해주세요'; errorEl.style.display = 'block'; return; }
        try {
            var res = await fetch('/api/auth/forgot-password', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email: email })
            });
            if (res.ok) {
                successEl.textContent = '해당 이메일이 존재하면 재설정 링크가 발송되었습니다.';
                successEl.style.display = 'block';
            } else {
                errorEl.textContent = '문제가 발생했습니다';
                errorEl.style.display = 'block';
            }
        } catch (e) {
            errorEl.textContent = '서버 오류';
            errorEl.style.display = 'block';
        }
    }
    document.getElementById('email').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') sendResetLink();
    });
    </script>
</div>
</body>
</html>
